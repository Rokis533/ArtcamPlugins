<html>

<head>
    <title>ArtCAM Vector Duplicator</title>
    <meta name="author" content="Steve Potter">
    <script src="../../html/SharedScripts/api.js"></script>
    <script src="../../html/SharedScripts/utils.js"></script>
    <script src="../../html/SharedScripts/edit.js"></script>
    <script language="JavaScript">
        function Initialise() {
            // Initialization code, if necessary
        }

        function CleanUp() {
            // Cleanup code, if necessary
        }

        function DuplicateVectors() {
            var xDuplicates = parseInt(document.getElementById('xDuplicateNumber').value);
            var yDuplicates = parseInt(document.getElementById('yDuplicateNumber').value);

            if (isNaN(xDuplicates) || isNaN(yDuplicates) || xDuplicates <= 0 || yDuplicates <= 0) {
                alert("Please enter valid positive numbers for duplication.");
                return;
            }

            var selectedVector = artcam.VectorSelection.GetSelectedVectors();
            if (selectedVector.length === 0) {
                alert("No vector selected.");
                return;
            }

            var vectorSize = artcam.VectorGeometry.GetVectorSize(selectedVector[0]);
            var newLayerName = "Layer_" + vectorSize.width + "x" + vectorSize.height;

            artcam.VectorLayers.CreateLayer(newLayerName);
            artcam.VectorLayers.SetActiveLayer(newLayerName);

            for (var i = 0; i < xDuplicates; i++) {
                for (var j = 0; j < yDuplicates; j++) {
                    var newVectorID = artcam.VectorSelection.Duplicate(selectedVector[0]);
                    artcam.VectorTransform.Translate(newVectorID, i * vectorSize.width, j * vectorSize.height);
                }
            }
        }
    </script>
</head>

<body class='dialogPage' onLoad='Initialise()' onunload='CleanUp()'>
    <table width="100%" border="0" cellspacing="0" style="TABLE-LAYOUT: fixed">
        <tr>
            <td valign="top"><img id="IMG1" src="../../html/SharedImages/Tools/SingleTool40.gif"></td>
            <td>
                <p><strong>ArtCAM Vector Duplicator</strong></p>
            </td>
        </tr>
        <tr>
            <td valign="top"></td>
            <td>
                <p>
                    <input id="xDuplicateNumber" name="xDuplicateNumber" type="number" value="1" min="1"> X Duplicates
                    <input id="yDuplicateNumber" name="yDuplicateNumber" type="number" value="1" min="1"> Y Duplicates
                </p>
            </td>
        </tr>
        <tr>
            <td valign="top"></td>
            <td>
                <input type="button" value="Duplicate" id="duplicate_but" name="duplicate_but"
                    onclick="DuplicateVectors()">
            </td>
        </tr>
    </table>

    <div align='right' style="m