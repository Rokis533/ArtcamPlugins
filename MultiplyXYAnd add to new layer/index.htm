<html>

<head>
    <title>ArtCAM Vector Duplicator</title>
    <meta name="author" content="Steve Potter">

    <!-- Load Scripts -->
    <script src="../../html/SharedScripts/api.js"></script>
    <script src="../../html/SharedScripts/utils.js"></script>
    <script src="../../html/SharedScripts/edit.js"></script>

    <!-- Local Script -->
    <script language="JavaScript">
        function Initialise() {
        }

        function CleanUp() {
        }

        function DuplicateVectors() {
            var xDuplicates = parseInt(document.getElementById('xDuplicateNumber').value);
            var yDuplicates = parseInt(document.getElementById('yDuplicateNumber').value);
            var selectedVector = artcam.SelectedVectorID;
            var vectorSize = artcam.GetVectorSize(selectedVector);

            var newLayerName = "Layer_" + vectorSize.Width + "x" + vectorSize.Height;
            artcam.CreateLayer(newLayerName);

            for (var i = 0; i < xDuplicates; i++) {
                for (var j = 0; j < yDuplicates; j++) {
                    artcam.DuplicateSelectedVector();
                    artcam.TranslateVector(i * vectorSize.Width, j * vectorSize.Height);
                }
            }

            artcam.SelectLayer(newLayerName);
        }
    </script>
</head>

<body class='dialogPage' onLoad='Initialise()' onunload='CleanUp()'>
    <table width="100%" border=0 cellspacing=0 style="TABLE-LAYOUT: fixed">
        <tr>
            <td valign=top><img id=IMG1 src="../../html/SharedImages/Tools/SingleTool40.gif"></td>
            <td>
                <p><strong>ArtCAM Vector Duplicator</strong></p>
            </td>
        </tr>
        <tr>
            <td valign=top></td>
            <td>
                <p>
                    <input id="xDuplicateNumber" name="xDuplicateNumber" type="number" value="1"> X Duplicates
                    <input id="yDuplicateNumber" name="yDuplicateNumber" type="number" value="1"> Y Duplicates
                </p>
            </td>
        </tr>
        <tr>
            <td valign=top></td>
            <td>
                <input type="button" value="Duplicate" id="duplicate_but" name="duplicate_but"
                    onclick="DuplicateVectors()">
            </td>
        </tr>
    </table>

    <div align='right' style="MARGIN-RIGHT: 10px">
        <hr>
        <input type='button' id='CloseButton' onclick='history.back()'>
        <script>CloseButton.value = "Close"</script>
        <p></p>
    </div>
</body>

</html>